FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvc3luYy1hcHAuaHRtbCIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVy\
czoKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlv\
bjogVVJMIG9mIHlvdXIgU3luYyBBcHBsaWNhdGlvbiBEb2NrZXIgSW1hZ2UsIGUuZy4gZG9ja2Vy\
LmlvL2Flcm9nZWFyL3ZveWFnZXItc2VydmVyLWV4YW1wbGUtdGFzawogICAgICAgIHR5cGU6IHN0\
cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRp\
b24gRG9ja2VyIGltYWdlCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfRE9DS0VSX0lNQUdFX1ZFUlNJ\
T04KICAgICAgICBkZXNjcmlwdGlvbjogVmVyc2lvbiBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24g\
RG9ja2VyIEltYWdlICh1c2luZyAnbGF0ZXN0JyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5\
cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFw\
cGxpY2F0aW9uIERvY2tlciBpbWFnZSB2ZXJzaW9uCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfSEVB\
TFRIX0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246IEhlYWx0aCBFbmRwb2ludCBvZiB5b3Vy\
IFN5bmMgQXBwbGljYXRpb24gKHVzaW5nICcvJyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5\
cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFw\
cGxpY2F0aW9uIGhlYWx0aCBlbmRwb2ludAogICAgICAtIG5hbWU6IFNZTkNfQVBQX1BPUlQKICAg\
ICAgICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUgU3luYyBBcHBsaWNhdGlvbiB0byBFeHBvc2UK\
ICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxl\
OiBTeW5jIEFwcCBQb3J0CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfR1JBUEhRTF9FTkRQT0lOVAog\
ICAgICAgIGRlc2NyaXB0aW9uOiBHcmFwaFFMIEVuZHBvaW50IG9mIHlvdXIgU3luYyBBcHBsaWNh\
dGlvbiAodXNpbmcgJ2dyYXBocWwnIGlmIG5vdCBzcGVjaWZpZWQpCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwIEdyYXBo\
UUwgRW5kcG9pbnQKICAgICAgLSBuYW1lOiBEQl9IT1NUTkFNRQogICAgICAgIGRlc2NyaXB0aW9u\
OiBIb3N0bmFtZSBvZiB0aGUgU1FMIFNlcnZlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgSG9zdG5hbWUKICAgICAg\
LSBuYW1lOiBEQl9QT1JUCiAgICAgICAgZGVzY3JpcHRpb246IFBvcnQgb2YgdGhlIFNRTCBTZXJ2\
ZXIKICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRp\
dGxlOiBTUUwgU2VydmVyIFBvcnQKICAgICAgLSBuYW1lOiBEQl9VU0VSTkFNRQogICAgICAgIGRl\
c2NyaXB0aW9uOiBVc2VybmFtZSB0aGF0IHdpbGwgYmUgdXNlZCB0byBjb25uZWN0IHRvIERhdGFi\
YXNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0\
aXRsZTogU1FMIFNlcnZlciBVc2VybmFtZQogICAgICAtIG5hbWU6IERCX1BBU1NXT1JECiAgICAg\
ICAgZGVzY3JpcHRpb246IFBhc3N3b3JkIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3QgdG8g\
RGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAg\
ICAgIHRpdGxlOiBTUUwgU2VydmVyIFBhc3N3b3JkCiAgICAgIC0gbmFtZTogREJfTkFNRQogICAg\
ICAgIGRlc2NyaXB0aW9uOiBOYW1lIG9mIHRoZSBTUUwgU2VydmVyJ3MgZGF0YWJhc2UKICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBEYXRh\
YmFzZSBuYW1lCiAgICAgIC0gbmFtZTogREJfU1NMCiAgICAgICAgZGVzY3JpcHRpb246IFVzZSBT\
U0wgY29ubmVjdGlvbiB0byBTUUwgU2VydmVyCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAg\
IGRpc3BsYXlfdHlwZTogY2hlY2tib3gKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIHRp\
dGxlOiBVc2UgU1NMPwogICAgYmluZF9wYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IENMSUVOVF9J\
RAogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQgSUQK\
ICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICAK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
